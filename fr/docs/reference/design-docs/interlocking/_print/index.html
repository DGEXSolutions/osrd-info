<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=fr class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.100.2"><link rel=canonical type=text/html href=https://osrd.fr/fr/docs/reference/design-docs/interlocking/><link rel=alternate type=application/rss+xml href=https://osrd.fr/fr/docs/reference/design-docs/interlocking/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Poste d'aiguillage | OSRD</title><meta name=description content="Décrit le fonctionnement du poste d'aiguillage virtuel"><meta property="og:title" content="Poste d'aiguillage"><meta property="og:description" content="Décrit le fonctionnement du poste d'aiguillage virtuel"><meta property="og:type" content="website"><meta property="og:url" content="https://osrd.fr/fr/docs/reference/design-docs/interlocking/"><meta property="og:site_name" content="OSRD"><meta itemprop=name content="Poste d'aiguillage"><meta itemprop=description content="Décrit le fonctionnement du poste d'aiguillage virtuel"><meta name=twitter:card content="summary"><meta name=twitter:title content="Poste d'aiguillage"><meta name=twitter:description content="Décrit le fonctionnement du poste d'aiguillage virtuel"><link rel=preload href=/scss/main.min.f03845650927da20a5e2e1fdc5e543de4fa1a463e0acedaca071fac4e82a8bf4.css as=style><link href=/scss/main.min.f03845650927da20a5e2e1fdc5e543de4fa1a463e0acedaca071fac4e82a8bf4.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/fr/><span class=navbar-logo><svg id="Calque_1" data-name="Calque 1" viewBox="0 0 64 64" sodipodi:docname="logo_osrd_seul_blanc.svg" width="64" height="64" inkscape:version="1.1.2 (0a00cf5339, 2022-02-04)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/"><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="3440" inkscape:window-height="1380" id="namedview47" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom="3.0016455" inkscape:cx="12.992873" inkscape:cy="71.294228" inkscape:window-x="0" inkscape:window-y="32" inkscape:window-maximized="1" inkscape:current-layer="Calque_1" inkscape:pagecheckerboard="0"/><defs id="defs4"><style id="style2">.cls-1,.cls-2,.cls-3,.cls-4,.cls-7{fill:none;stroke-linecap:round;stroke-linejoin:round}.cls-1,.cls-4{stroke:#aa026d}.cls-1,.cls-2{stroke-width:10px}.cls-2,.cls-3{stroke:#71196f}.cls-3,.cls-4{stroke-width:5px}.cls-5,.cls-6{font-size:119.48px}.cls-5{fill:#71196f;font-family:AvenirLTStd-Heavy,Avenir LT Std}.cls-6{fill:#aa026d;font-family:AvenirLTStd-Medium,Avenir LT Std}.cls-7{stroke:#fff;stroke-width:.75px}</style></defs><title id="title6">logo-OSRD_</title><g id="g847" transform="matrix(0.09645818,0,0,0.09645818,7.1489968,-1.215e-6)"><path inkscape:connector-curvature="0" class="cls-1" d="m389.52 658.5v-88c0-199.26-91.83-331.42-279.82-362" id="path8" style="stroke:#f2f2f2;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-1" d="m298.5 658.5v-87.07c0-156.89-75.34-258.73-229.71-276" id="path10" style="stroke:#f2f2f2;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-2" d="m216.77 658.5v-70.49c0-121.76-58.68-200.64-178.91-213.6" id="path12" style="stroke:#a0a0a0;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-2" d="M125.74 658.5V617.36C125.74 533.21 86.13 478 5 466.95" id="path14" style="stroke:#a0a0a0;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-2" d="m125.74 658.5v-88c0-199.26 91.84-331.42 279.83-362" id="path16" style="stroke:#a0a0a0;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-2" d="m216.77 658.5v-87.07c0-156.89 75.34-258.73 229.71-276" id="path18" style="stroke:#a0a0a0;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-1" d="m298.5 658.5v-70.49c0-121.76 58.68-200.64 178.91-213.6" id="path20" style="stroke:#f2f2f2;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-1" d="m389.52 658.5v-41.14c0-84.15 39.62-139.36 120.75-150.41" id="path22" style="stroke:#f2f2f2;stroke-opacity:1"/><line class="cls-3" x1="126" y1="642.5" x2="126" y2="122.5" id="line24" style="stroke:#a0a0a0;stroke-opacity:1"/><line class="cls-3" x1="217" y1="642.5" x2="217" y2="2.5" id="line26" style="stroke:#a0a0a0;stroke-opacity:1"/><line class="cls-4" x1="299" y1="642.5" x2="299" y2="2.5" id="line28" style="stroke:#f7f7f7;stroke-opacity:1"/><line class="cls-4" x1="390" y1="642.5" x2="390" y2="122.5" id="line30" style="stroke:#f2f2f2;stroke-opacity:1"/></g></svg></span><span class=font-weight-bold>OSRD</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/fr/about/><span>À propos</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/fr/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/fr/blog/><span>Blog</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Français</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/en/>English</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Rechercher" aria-label=Rechercher autocomplete=off data-offline-search-index-json-src=/offline-search-index.52051f2b277f625752fd68f13a5420fc.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>Version imprimable multipages.
<a href=# onclick="return print(),!1">Cliquer ici pour imprimer</a>.</p><p><a href=/fr/docs/reference/design-docs/interlocking/>Retour à la version par défaut</a>.</p></div><h1 class=title>Poste d'aiguillage</h1><div class=lead>Décrit le fonctionnement du poste d&rsquo;aiguillage virtuel</div><ul><li>1: <a href=#pg-ee6003e9414db3f0e05978636a844345>Éléments mobiles</a></li><li>2: <a href=#pg-f9ae9ad8e8b03f8f0fcbef3b7d4be0b9>Localisation</a></li><li>3: <a href=#pg-102b27462f1d7abc5a5824a7ba5d0b82>Reservation</a></li><li>4: <a href=#pg-db83f9bbda0f6a9be54f5872c94185f4>Routage</a></li><li>5: <a href=#pg-d84f7d18068af2c677e12c6761184b2f>Ordonnancement</a></li><li>6: <a href=#pg-7430cbed022a567839d982205fb6211d>Train</a></li></ul><div class=content><p>Le modèle de simulation définit le rôle et comportement des différents objets simulés au sein d&rsquo;OSRD.</p><p>Cette modélisation est un compromis entre de multiples enjeux:</p><ul><li>fidélité de la simulation</li><li>interprétabilité des résultats</li><li>adaptabilité du modèle à différentes technologies et usages, que cela soit en terme de signalisation, de poste d&rsquo;aiguillage, ou d&rsquo;usage des données</li></ul><p>En particulier, certaines subtilités propres aux systèmes pratiques ont été sacrifiées sur l&rsquo;autel de la compatibilité et de l&rsquo;interprétabilité:</p><ul><li>un signal doit forcément s&rsquo;addresser à un train en particulier: les signaux n&rsquo;ont pas d&rsquo;aspect par défaut; ils n&rsquo;existent que pour être vus</li><li>les itinéraires / routes sont formées à destination d&rsquo;un train en particulier</li></ul><div class="pageinfo pageinfo-info"><p>Ce document est une description du modèle de fonctionnement cible d&rsquo;OSRD.
Il a pour objectif de renseigner développeurs et experts métiers sur le fonctionnement du simulateur.
Des changements y sont apportés au fil de l&rsquo;évolution du projet.</p></div><div class="pageinfo pageinfo-warning"><p>Ce modèle est en cours d&rsquo;implémentation</p></div><h2 id=architecture>Architecture</h2><pre tabindex=0><code class=language-mermaid data-lang=mermaid>flowchart TD
    %%%% NODES

    train[Train]
    %% ↓
    signaling[Signalisation]
    %% ↓
    routing[Routage]
    ordering[Ordonnancement]
    %% ↓
    reservation[Réservation]
    %% ↓
    location[Localisation]
    movable-elements[&#34;Éléments mobiles&#34;]

    %%%% EDGES

    train -- réagit à --&gt; signaling
    train -- réclame les itinéraires --&gt; ordering
    ordering -- commande --&gt; routing
    signaling -- observe --&gt; reservation
    routing -- observe et réserve --&gt; reservation
    reservation -- observe --&gt; location
    reservation -- actionne --&gt; movable-elements
    train -- informe --&gt; location

    %%%% CLICKABLE LINKS

    click train href &#34;./train/&#34; _self
    click ordering href &#34;./ordering/&#34; _self
    click signaling href &#34;./signaling/&#34; _self
    click routing href &#34;./routing/&#34; _self
    click reservation href &#34;./reservation/&#34; _self
    click location href &#34;./location/&#34; _self
    click movable-elements href &#34;./movable-elements/&#34; _self
</code></pre><div class="alert alert-info" role=alert><h4 class=alert-heading>Pistes d'évolution</h4><ul><li>Gestion des overlaps</li></ul></div><h2 id=remerciements>Remerciements</h2><p>Par ordre alphabétique:</p><ul><li>Christophe Mémin</li><li>Djamal Bellebia</li><li>Gilles Dessagne</li><li>Nathanaël Dias</li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-ee6003e9414db3f0e05978636a844345>1 - Éléments mobiles</h1><div class=lead>Gère l&rsquo;état des organes de commande des aiguilles, passages à niveau, …</div><h2 id=description>Description</h2><p>Chaque élément mobile, aiguille ou passage à niveau, a une liste d&rsquo;états possibles.
Ces états sont mutuellement exclusifs.</p><h2 id=dépendances>Dépendances</h2><ul><li><code>statique</code> une liste d&rsquo;élements mobiles</li><li><code>statique</code> liste des états possibles de chaque élément mobile</li></ul><h2 id=opérations-possibles>Opérations possibles</h2><ul><li>observer un élément mobile</li><li>verrouiller / déverrouiller un élément mobile</li><li>bouger un élément mobile</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f9ae9ad8e8b03f8f0fcbef3b7d4be0b9>2 - Localisation</h1><div class=lead>Fournit les informations de position des trains sur le réseau</div><h2 id=description>Description</h2><p>La couche de localisation permet à d&rsquo;autres modules de simulation de suivre le déplacement du train dans l&rsquo;infrastructure.
L&rsquo;infrastructure ferroviaire est découpée en régions appelées zones. Quand on train entre dans une zone, ce module permet d&rsquo;en être notifié.</p><p>Les zones (ou TVDSection / DetectionSection) sont des partitions physiques des voies :</p><ul><li>capables de détecter la présence d&rsquo;un train</li></ul><h2 id=exigences-de-conception>Exigences de conception</h2><ul><li>il doit être possible de suivre les changements d&rsquo;occupation d&rsquo;une zone</li><li>il <em>devra</em> être possible de suivre les déplacements d&rsquo;un train</li><li>il <em>devra</em> être possible d&rsquo;implémenter un système de bloc mobile</li></ul><h2 id=dépendances>Dépendances</h2><ul><li><code>statique</code> une liste de zones</li></ul><h2 id=opérations>Opérations</h2><ul><li>Occuper une zone</li><li>Libérer une zone</li><li>Observer les changements d&rsquo;occupation d&rsquo;une zone</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-102b27462f1d7abc5a5824a7ba5d0b82>3 - Reservation</h1><div class=lead>Gère l&rsquo;état de réservation des zones</div><div class="alert alert-warning" role=alert>Le mot réservation ici a pour sens réservation de la resource itinéraire, et non le sens commande plannifiée d&rsquo;itinéraire</div><h2 id=description>Description</h2><p>Les zones (ou TVDSection / DetectionSection) sont des partitions physiques des voies :</p><ul><li>capables de détecter la présence d&rsquo;un train</li><li>qui fournissent un service de réservation à l&rsquo;usage des routes</li></ul><p>Chaque zone a un certain nombre de configurations différentes.
Par exemple, une zone sans aiguille aura deux configurations :</p><ul><li>sens pair</li><li>sens impair</li></ul><p>Une zone avec une aiguille aura 4 configurations possibles :</p><ul><li>sens pair voie principale</li><li>sens impair voie principale</li><li>sens pair voie déviation</li><li>sens impair voie déviation</li></ul><p><strong>Chaque zone ne peut être réservée que pour une configuration donnée à la fois, mais peut être réservée simultanément par plusieurs routes</strong>.
Une zone ne peut changer de configuration que lorsqu&rsquo;elle n&rsquo;est pas réservée.</p><div class="alert alert-info" role=alert><p>En discutant avec des experts métiers, vont entendrez parler d&rsquo;<a href=https://fr.wikipedia.org/wiki/Enclenchement>enclenchements</a>:
le terme viens de l&rsquo;époque où les postes de signalisations étaient entièrement mécaniques.
Les enclenchements étaient alors des objets physiques qui empêchaient certaines configurations.</p><p>Une conséquence de cet héritage historique et que beaucoup de règles ferroviaires sont exprimées par contraintes au lieu d&rsquo;être exprimées par garanties.
Un enclenchement, c&rsquo;est une garantie qu&rsquo;une situation particulière ne peut pas se produire.</p></div><h3 id=état-dynamique-dune-zone>État dynamique d&rsquo;une zone</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#204a87;font-weight:700>enum</span> <span style=color:#000>ZoneState</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// A list of active reservations.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// Each reservation requires a particular configuration to be upheld.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>reservations</span>: <span style=color:#000>VecDeque</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ZoneReservation</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000>ZoneReservation</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// The train which requires this reservation
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>train</span>: <span style=color:#000>TrainHandle</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// The configuration required for this reservation
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>requirements</span>: <span style=color:#000>ZoneRequirements</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// The state of this reservation
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>status</span>: <span style=color:#000>ZoneReservationStatus</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>enum</span> <span style=color:#000>ZoneReservationStatus</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// In the process of being reserved, but not yet ready
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>PRE_RESERVED</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// The train can arrive anytime
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>RESERVED</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// The train is inside the zone
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>OCCUPIED</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// The zone is pending release
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>PENDING_RELEASE</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000>ZoneRequirements</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>entry</span>: <span style=color:#204a87>Option</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DirDetector</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>exit</span>: <span style=color:#204a87>Option</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DirDetector</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>movable_elements</span>: <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>MovableElement</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>MovableElementConfig</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>impl</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ZoneState</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>/// Get the combined requirements for all the currently active reservations
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>fn</span> <span style=color:#000>get_combined_requirements</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#3465a4>self</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span>-&gt; <span style=color:#204a87>Option</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ZoneRequirements</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>return</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#3465a4>self</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>reservations</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#000;font-weight:700>.</span><span style=color:#000>map</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>|</span><span style=color:#000>res</span><span style=color:#ce5c00;font-weight:700>|</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>requirements</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#000;font-weight:700>.</span><span style=color:#000>reduce</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>|</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#ce5c00;font-weight:700>|</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ZoneRequirements</span>::<span style=color:#000>combine</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=exigences-de-conception>Exigences de conception</h2><ul><li>Les zones doivent pouvoir être <strong>verrouillées</strong> dans une configuration particulière.</li><li>Il doit être possible pour plusieurs routes de <strong>partager une réservation</strong> de configuration.</li><li>Il doit être possible d&rsquo;observer l&rsquo;<strong>évolution de statut d&rsquo;une réservation</strong>.</li><li>Il doit être possible de faire évoluer le statut d&rsquo;une réservation.</li></ul><h2 id=dépendances>Dépendances</h2><ul><li><code>statique</code> les détecteurs qui délimitent chaque zone</li><li><code>statique</code> les aiguilles dans chaque zone</li><li><code>dynamique</code> capacité d&rsquo;observer l&rsquo;occupation des zones</li><li><code>dynamique</code> capacité d&rsquo;actionner les éléments mobiles</li></ul><h2 id=opérations>Opérations</h2><ul><li><strong>espacement</strong>: Observer l&rsquo;état d&rsquo;une zone</li><li><strong>routage</strong>: Verrouiller et déverrouiller la zone : permet d&rsquo;obtenir un droit d&rsquo;action. Toutes les opérations en écriture nécessitent d&rsquo;avoir acquis le verrou.</li><li><strong>routage</strong>: Attendre que toutes les réservations d&rsquo;une zone expirent</li><li><strong>routage</strong>: Pré-réserver une configuration de zone</li><li><strong>routage</strong>: Confirmer la réservation d&rsquo;une zone</li><li><strong>routage</strong>: Attendre que la réservation de la zone soit occupée par son train</li><li><strong>routage</strong>: Relacher une réservation de zone</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-db83f9bbda0f6a9be54f5872c94185f4>4 - Routage</h1><div class=lead>Gère le cycle des routes</div><h2 id=description>Description</h2><ul><li>Les routes ont pour responsabilité d&rsquo;autoriser le déplacement des trains dans l&rsquo;infrastructure. Elles doivent se terminer à un point où l&rsquo;arrêt du train est prévu (en terme de signalisation, pas voyageur).</li><li>Les routes sont assimilables à des itinéraires, ou à des suites d&rsquo;itinéraires et d&rsquo;installations de pleine voie.</li><li>Les routes n&rsquo;ont pas de lien direct avec le cantonnement et la signalisation. Elles nourissent des informations sur la disponibilité des voies qui sont utilisées par le cantonnement et la signalisation.</li><li>Une route est un chemin de détecteur en détecteur. Elle représente une portion de chemin qu&rsquo;il est sûr pour un train d&rsquo;emprunter.</li><li>Les routes ont des points de libération, qui sont des détecteurs qui délimitent quand détruire l&rsquo;itinéraire, ce qui permet d&rsquo;implémenter transit souple, rigide, et entre-deux.</li><li>Une route peut être à nouveau formée alors qu&rsquo;un train est déjà en train de la parcourir. Cela permet à plusieurs trains de se suivre sur la même route.</li></ul><h3 id=cycle-de-vie-dune-route>Cycle de vie d&rsquo;une route</h3><p>Les routes n&rsquo;ont pas d&rsquo;état, mais leur commande donne lieu à une suite d&rsquo;événements systématique :</p><ul><li>le système commande toutes les routes sur le trajet du train dans l&rsquo;ordre, sans attendre<ul><li>la commande doit être acceptée par le <strong>régulateur</strong></li></ul></li><li>lorsque le régulateur accepte la commande, la <strong>formation</strong> commence<ul><li>le droit d&rsquo;action de chaque zone de la route est acquis, selon un ordre global</li><li>en parallèle pour toutes les zones:<ul><li>si la zone n’est pas dans la configuration souhaitée:<ul><li>si elle est déjà réservée, attendre que les réservations expirent</li><li>sinon, la mettre dans la configuration souhaitée en déplaçant les aiguilles</li></ul></li><li>pré-réserver la zone pour le passage du train</li><li>le droit d&rsquo;action de la zone est cédé</li></ul></li></ul></li><li>une fois que la formation est terminée, la route est <strong>établie</strong><ul><li>pour chaque zone, transformer la pré-réservation du train en réservation</li></ul></li><li>dès que la route est établie, un processus de <strong>destruction de la route</strong> commence<ul><li>pour chaque zone de la route donnant lieu à une libération<ul><li>attendre que le train quitte la zone (que la réservation passe de l&rsquo;état <code>OCCUPIED</code> à l&rsquo;état <code>PENDING_RELEASE</code>)</li><li>libérer la réservation des zones du début de la route jusqu&rsquo;à la zone actuelle</li></ul></li></ul></li></ul><div class="alert alert-info" role=alert><h4 class=alert-heading>Piste d'évolution</h4>Certains postes d&rsquo;aiguillages ont un enclenchement entre itinéraires de sens contraire (affrontement) qui empêche l&rsquo;activation d&rsquo;une route en menant à une zone avec un transit en sens contraire. Il serait envisageable de réserver une zone supplémentaire à la fin du chemin protégé par la route, par sécurité.</div><div class="alert alert-info" role=alert><h4 class=alert-heading>Piste d'évolution</h4>Certains itinéraires en gare ne permettent pas le partage du chemin par plusieurs trains</div><div class="alert alert-info" role=alert><h4 class=alert-heading>Piste d'évolution</h4>En pratique, il pourrait être intéressant d&rsquo;introduire une notion de route partielle afin de réduire le nombre de routes nécessaires: une route partielle est une portion de route qu&rsquo;il n&rsquo;est pas sûr d&rsquo;activer indépendament.</div><h2 id=exigences-de-conception>Exigences de conception</h2><p>Le système doit, indirectement ou directement:</p><ul><li>permettre à la <strong>signalisation</strong> de déterminer si une section de voie est <strong>prête à être empruntée</strong>.</li><li>permettre l&rsquo;<strong>ordonnancement</strong> des trains selon des critères configurables.</li><li>permettre la destruction progressive (<strong>transit souple</strong>) de l&rsquo;itinéraire après le passage du train.</li><li>il doit être possible d&rsquo;avoir plusieurs processus de commande actifs au même moment pour la même route, afin de supporter des trains qui se suivent</li></ul><h2 id=dépendances>Dépendances</h2><ul><li><p><code>statique</code> le chemin des routes de détecteur à détecteur</p></li><li><p><code>statique</code> la position requise des aiguilles, par zone</p></li><li><p><code>statique</code> les points de libération des zones (qui implémentent le transit souple / rigide)</p></li><li><p><code>dynamique</code> <code>régulateur</code> soumettre des commandes</p></li><li><p><code>dynamique</code> <code>réservation</code> acquérir et relacher un droit d&rsquo;action par zone</p></li><li><p><code>dynamique</code> <code>réservation</code> attendre que les réservations d&rsquo;une zone expirent</p></li><li><p><code>dynamique</code> <code>éléments mobiles</code> déplacer des aiguilles</p></li><li><p><code>dynamique</code> <code>réservation</code> pré-réserver une zone</p></li><li><p><code>dynamique</code> <code>réservation</code> promouvoir une pré-réservation en réservation</p></li><li><p><code>dynamique</code> <code>réservation</code> lors de la destruction de la route, attendre qu&rsquo;une réservation passe en <code>PENDING_RELEASE</code></p></li><li><p><code>dynamique</code> <code>réservation</code> libérer une réservation</p></li></ul><h2 id=opérations>Opérations</h2><ul><li><strong>commander une route</strong>: démarre un processus asynchrone qui ne se terminera que lorsque la route aura été établie. <strong>Un processus de destruction doit démarrer dès que la route est établie</strong>.</li></ul><h2 id=notes-de-conception>Notes de conception</h2><p>Ces notes permettent d&rsquo;expliquer les décisions qui ont été prises, afin de pouvoir plus aisément les comprendre et évoluer.</p><h3 id=informer-la-signalisation>Informer la signalisation</h3><p>Sachant que:</p><ul><li>il peut y avoir beaucoup de zones partant d&rsquo;un même point, il est préférable d&rsquo;éviter de contraindre les signaux à observer une liste de routes</li><li>il est potentiellement difficile d&rsquo;associer un état clair à chaque route</li></ul><p>Il en ressort plusieurs manières d&rsquo;informer la signalisation de la navigabilité des voies:</p><ul><li>soit <strong>directement</strong>, en faisant observer à la signalisation les points d&rsquo;entrée des routes. Si plusieurs routes partent du même endroit, elles partageraient un objet entrée:<ul><li>moins de complexité dans la couche de réservation, plus de complexité dans la couche de routage</li></ul></li><li>soit <strong>indirectement</strong>, via la couche de réservation des zones, qui auraient un état supplémentaire pour marquer leur navigabilité:<ul><li>moins de complexité dans la couche de routage, plus de complexité dans la couche de réservation</li><li><code>avantage</code> le processus d&rsquo;activation des routes n&rsquo;aurait pas besoin d&rsquo;attendre l&rsquo;arrivée du train, la couche de réservation s&rsquo;en occuperait.</li><li><code>avantage</code> découplage entre routage et cantonnement / signalisation.</li></ul></li></ul><p>La seconde option a été choisie, car :</p><ul><li>elle permet d&rsquo;avoir un couplage moins fort entre la signalisation et les routes.</li><li>elle évite aussi au processus d&rsquo;activation des routes d&rsquo;attendre le passage du train alors que la couche de réservation le fait déjà.</li></ul><h3 id=cycle-de-vie-des-routes-et-état-des-zones>Cycle de vie des routes et état des zones</h3><p>Plusieurs enjeux motivent le cycle de vie des routes et l&rsquo;état des zones :</p><ul><li>d&rsquo;une part, l&rsquo;état des zones est au coeur de la détection de conflit : il doit être possible d&rsquo;extraire d&rsquo;une simulation d&rsquo;un train seul ses besoins en ressources</li><li>d&rsquo;autre part, il faut qu&rsquo;une simulation multi-train fonctionne correctement : le temps de déplacement des aiguilles selon la configuration actuellement en place, en particulier, est un point de friction important</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d84f7d18068af2c677e12c6761184b2f>5 - Ordonnancement</h1><div class=lead>Décide de l&rsquo;ordre de formation des itinéraires</div><div class="alert alert-warning" role=alert>Cette page est une ébauche, contribuez-y!</div><h2 id=définition>Définition</h2><p>La couche d&rsquo;ordonnancement a pour responsabilité d&rsquo;établir l&rsquo;ordre de commande des itinéraires, et par conséquent, l&rsquo;ordre de passage des trains.
La méthode exacte utilisée pour prendre cette décision n&rsquo;importe pas, du moment qu&rsquo;elle garanti que la simulation se termine (elle ne doit pas amener de trains en nez-à-nez, ou créer d&rsquo;autre cas de figure de blocage).</p><p>Il est possible d&rsquo;implémenter un module d&rsquo;ordonnancement via des tableaux d&rsquo;ordre de succession des trains aux aiguilles.</p><h2 id=exigences-de-conception>Exigences de conception</h2><ul><li>Il doit être possible de connecter n&rsquo;importe quel algorithme d&rsquo;ordonnancement</li><li>Le module d&rsquo;ordonnancement doit approuver les commandes de routes.</li></ul><h2 id=opérations>Opérations</h2><ul><li><strong>train</strong>: Des itinéraires sont <strong>commandés</strong> pour chaque trains, aussi loin et aussi tôt que possible. L&rsquo;approbation de la commande est soumise au régulateur, qui peut la retarder indéfiniment, selon des critères de son choix.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-7430cbed022a567839d982205fb6211d>6 - Train</h1><div class=lead>Représente un train dans la simulation</div><h2 id=description>Description</h2><p>Les contraintes sur ce qu&rsquo;est un train sont relativement faibles.
Il doit seulement avoir un identifiant, qui permet aux autres systèmes de garder des références vers des trains.</p><h2 id=exigences-de-conception>Exigences de conception</h2><ul><li>Les trains <strong>occupent les zones</strong>.</li><li>Les trains doivent être <strong>suivis</strong> pour préserver leur <strong>ordre de passage</strong>.</li><li>Les trains ont pour responsabilité de <strong>demander les itinéraires</strong> devant eux.</li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/osrd-project/osrd aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Contributeurs à OSRD. Tous droits réservés</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/mermaid@8.13.4/dist/mermaid.min.js integrity="sha512-JERecFUBbsm75UpkVheAuDOE8NdHjQBrPACfEQYPwvPG+fjgCpHAz1Jw2ci9EXmd3DdfiWth3O3CQvcfEg8gsA==" crossorigin=anonymous></script><style>.markmap>svg{width:100%;height:300px}</style><script>window.markmap={autoLoader:{manual:!0}}</script><script src=https://cdn.jsdelivr.net/npm/markmap-autoloader></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.928c8c2d8b4f463998503da833bc465b748d40b80287e0398a7e1a38ab1c87a2.js integrity="sha256-koyMLYtPRjmYUD2oM7xGW3SNQLgCh+A5in4aOKsch6I=" crossorigin=anonymous></script></body></html>