<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.100.2"><link rel=canonical type=text/html href=https://osrd.fr/en/docs/reference/design-docs/stdcm/><link rel=alternate type=application/rss+xml href=https://osrd.fr/en/docs/reference/design-docs/stdcm/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Search for last-minute train slots (STDCM) | OSRD</title><meta name=description content="OSRD can be used to find a slot for a train in an already established
timetable, without causing conflicts with other trains.
The acronym STDCM (Short …"><meta property="og:title" content="Search for last-minute train slots (STDCM)"><meta property="og:description" content="Open Source Railway Designer"><meta property="og:type" content="website"><meta property="og:url" content="https://osrd.fr/en/docs/reference/design-docs/stdcm/"><meta property="og:site_name" content="OSRD"><meta itemprop=name content="Search for last-minute train slots (STDCM)"><meta itemprop=description content="Open Source Railway Designer"><meta name=twitter:card content="summary"><meta name=twitter:title content="Search for last-minute train slots (STDCM)"><meta name=twitter:description content="Open Source Railway Designer"><link rel=preload href=/scss/main.min.f03845650927da20a5e2e1fdc5e543de4fa1a463e0acedaca071fac4e82a8bf4.css as=style><link href=/scss/main.min.f03845650927da20a5e2e1fdc5e543de4fa1a463e0acedaca071fac4e82a8bf4.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/en/><span class=navbar-logo><svg id="Calque_1" data-name="Calque 1" viewBox="0 0 64 64" sodipodi:docname="logo_osrd_seul_blanc.svg" width="64" height="64" inkscape:version="1.1.2 (0a00cf5339, 2022-02-04)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/"><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="3440" inkscape:window-height="1380" id="namedview47" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom="3.0016455" inkscape:cx="12.992873" inkscape:cy="71.294228" inkscape:window-x="0" inkscape:window-y="32" inkscape:window-maximized="1" inkscape:current-layer="Calque_1" inkscape:pagecheckerboard="0"/><defs id="defs4"><style id="style2">.cls-1,.cls-2,.cls-3,.cls-4,.cls-7{fill:none;stroke-linecap:round;stroke-linejoin:round}.cls-1,.cls-4{stroke:#aa026d}.cls-1,.cls-2{stroke-width:10px}.cls-2,.cls-3{stroke:#71196f}.cls-3,.cls-4{stroke-width:5px}.cls-5,.cls-6{font-size:119.48px}.cls-5{fill:#71196f;font-family:AvenirLTStd-Heavy,Avenir LT Std}.cls-6{fill:#aa026d;font-family:AvenirLTStd-Medium,Avenir LT Std}.cls-7{stroke:#fff;stroke-width:.75px}</style></defs><title id="title6">logo-OSRD_</title><g id="g847" transform="matrix(0.09645818,0,0,0.09645818,7.1489968,-1.215e-6)"><path inkscape:connector-curvature="0" class="cls-1" d="m389.52 658.5v-88c0-199.26-91.83-331.42-279.82-362" id="path8" style="stroke:#f2f2f2;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-1" d="m298.5 658.5v-87.07c0-156.89-75.34-258.73-229.71-276" id="path10" style="stroke:#f2f2f2;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-2" d="m216.77 658.5v-70.49c0-121.76-58.68-200.64-178.91-213.6" id="path12" style="stroke:#a0a0a0;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-2" d="M125.74 658.5V617.36C125.74 533.21 86.13 478 5 466.95" id="path14" style="stroke:#a0a0a0;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-2" d="m125.74 658.5v-88c0-199.26 91.84-331.42 279.83-362" id="path16" style="stroke:#a0a0a0;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-2" d="m216.77 658.5v-87.07c0-156.89 75.34-258.73 229.71-276" id="path18" style="stroke:#a0a0a0;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-1" d="m298.5 658.5v-70.49c0-121.76 58.68-200.64 178.91-213.6" id="path20" style="stroke:#f2f2f2;stroke-opacity:1"/><path inkscape:connector-curvature="0" class="cls-1" d="m389.52 658.5v-41.14c0-84.15 39.62-139.36 120.75-150.41" id="path22" style="stroke:#f2f2f2;stroke-opacity:1"/><line class="cls-3" x1="126" y1="642.5" x2="126" y2="122.5" id="line24" style="stroke:#a0a0a0;stroke-opacity:1"/><line class="cls-3" x1="217" y1="642.5" x2="217" y2="2.5" id="line26" style="stroke:#a0a0a0;stroke-opacity:1"/><line class="cls-4" x1="299" y1="642.5" x2="299" y2="2.5" id="line28" style="stroke:#f7f7f7;stroke-opacity:1"/><line class="cls-4" x1="390" y1="642.5" x2="390" y2="122.5" id="line30" style="stroke:#f2f2f2;stroke-opacity:1"/></g></svg></span><span class=font-weight-bold>OSRD</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/en/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/en/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/en/blog/><span>Blog</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/fr/docs/reference/design-docs/stdcm/>Français</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.36e4cc9881fd843160843ae0853683b0.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/en/docs/reference/design-docs/stdcm/>Return to the regular view of this page</a>.</p></div><h1 class=title>Search for last-minute train slots (STDCM)</h1><ul><li>1: <a href=#pg-947b82c2b20e8d312398ef2a5634cd3c>Business context</a></li><li>2: <a href=#pg-f0e665bd09334507f4e0f2438621834b>Train slot search module</a></li><ul><li>2.1: <a href=#pg-a4f78c201b7f1d0e1991144fff21f26a>Input format</a></li><li>2.2: <a href=#pg-12bb8a99ebcc826ad37983a300610aed>Encoding the solution space</a></li><li>2.3: <a href=#pg-74094845d6db946e31db476ef1c506a2>Discontinuities and backtracking</a></li><li>2.4: <a href=#pg-615ce0cf6c404cd85469e6285e5feb90>Conflict avoidance</a></li><li>2.5: <a href=#pg-ed97b39b0c3816e4f1073f363957a3e3>Standard allowance</a></li><li>2.6: <a href=#pg-460b1be4e2f2584372a451ceef833731>Implementation details</a></li></ul><li>3: <a href=#pg-8ee6423983b11793e61c99ce092f6373>Signaling interface</a></li></ul><div class=content><p>OSRD can be used to find a slot for a train in an already established
timetable, without causing conflicts with other trains.</p><p>The acronym STDCM (Short Term Digital Capacity Management) is used
to describe this concept in general.</p></div></div><div class=td-content><h1 id=pg-947b82c2b20e8d312398ef2a5634cd3c>1 - Business context</h1><p>Some definitions:</p><h3 id=capacity>Capacity</h3><p><strong>Capacity</strong>, in this context, is the ability to
reserve infrastructure elements to allow the passage of a train.</p><p>Capacity is expressed in both space and time:
the reservation of an element can block a specific zone
that becomes inaccessible to other trains, and this reservation
lasts for a given time interval.</p><p>It can be displayed
on a chart, with the time on the horizontal axis
and the distance traveled on the vertical axis.</p><p><img src=space_time_chart.png alt="Space-time chart"></p><blockquote><p>Example of a space-time chart displaying the passage of a train.</p><p>The colors here represent aspects of the signals, but
display a consumption of the capacity as well:
when these blocks overlap for two trains, they conflict.</p></blockquote><p>There is a <strong>conflict</strong> between two trains when they reserve
the same object at the same time, in incompatible configurations.</p><p><img src=conflict.png alt="Space-time chart with conflict"></p><blockquote><p>Example of a space-time graph with a conflict: the second train
is faster than the first one, they are in conflict at the end
of the path, when the rectangles overlap.</p><p>When simulating this timetable, the second train would be
slowed down by the yellow signals, caused by the
presence of the first train.</p></blockquote><h3 id=train-slots>Train slots</h3><p>A <strong>train slot</strong> corresponds to a capacity reservation
for the passage of a train. It is fixed in space and time:
the departure time and the path taken are known.
On the space-time charts in this page, a train slot corresponds
to the set of blocks displayed for a train.</p><blockquote><p>Note: in English-speaking countries, these are often simply called &ldquo;train paths&rdquo;.
But in this context, this name would be ambiguous with the
physical path taken by the train.</p></blockquote><p>The usual procedure is for the infrastructure manager
(e.g. SNCF Réseau) to offers train slots for sale to
railway companies (e.g. SNCF Voyageurs).</p><p>At a given date before the scheduled day of operation,
all the train paths are allocated. But <strong>there may be
enough capacity to fit more trains</strong>. Trains can fit between
scheduled slots,
when they are sufficiently far apart or have not found a buyer.</p><p>The remaining capacity after the allocation of train paths is called
<strong>residual capacity</strong>. This section explains how OSRD looks
for train slots in this residual capacity.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f0e665bd09334507f4e0f2438621834b>2 - Train slot search module</h1><p>This module handles the search for solutions.</p><p>To reduce the problem to its simplest form and for easy and efficient
testing, inputs and outputs are strongly simplified and abstracted.</p><p>To summarize its behavior:
the solution space is described as a graph that encodes locations,
time, and speed. A pathfinding is run on this graph to find a solution.</p><p>This graph could, in a way, be seen as a decision tree,
but different paths can lead to the same node.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a4f78c201b7f1d0e1991144fff21f26a>2.1 - Input format</h1><p>This module takes several parameters to find a path:</p><ul><li>A graph describing the physical infrastructure</li><li>Unavailable sections in time intervals</li><li>Origin and destination point(s)</li><li>Departure time interval</li><li>Maximum run time</li><li>Simulation parameters (rolling stock, time step, allowances, &mldr;)</li></ul><p>Among those, the first 3 require more explanations.</p><h4 id=infrastructure-graph>Infrastructure graph</h4><p>Today, the input graph is the <code>SignalingRoutes</code> graph.
But it can be any graph that represents the physical infrastructures
and the paths that can be used.</p><p>The only constraints are: the edges must have a length, and it must
be possible to compute running time on parts of an edge.</p><h4 id=unavailable-sections>Unavailable sections</h4><p>This input encodes the areas that are unavailable because of
capacity constraints.</p><p>Every edge has a set of &ldquo;occupancy block&rdquo;. A block is made of these elements:</p><ul><li>Start offset</li><li>End offset</li><li>Start time</li><li>End time</li></ul><p>Offsets are relative to the start of the edge. Each block means that
the <em>head</em> of the train cannot be located in the edge
segment during the given interval.</p><p>These blocks include the grid margin. If the solution needs to have
an <code>x</code> seconds margin before the train passage, every block ends
<code>x</code> seconds later.</p><p>To give an example, with the following schedule, a 42m long train,
and 10m sight distance:</p><p><img src=unavailable_sections.svg alt="Unavailable section example"></p><ul><li>The occupancy of the block 1 from t=0 to t=300 makes it unavailable
in its entirety during this time</li><li>The last 10 meters of block 1 are unavailable from t=300 to t=360,
because the signal at the start of block 2 must be green when the
conductor sees it. It is possible to consider that this unavailability block
starts at t=130 (when the next signal isn&rsquo;t green), as blocks can overlap.</li><li>The occupancy of block 2 from t=130 to t=360 makes it unavailable
during this time. It is also unavailable from t=0, as the presence of a
train in this block would cause a warning on block 1.</li><li>The first 42 meters of block 3 are unavailable from t=0 to t=360,
because the tail of the train must have left the block 2 at this time.</li><li>The rest of block 3 is unavailable in its entirety from t=280 to t=360</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-12bb8a99ebcc826ad37983a300610aed>2.2 - Encoding the solution space</h1><h4 id=general-principle>General principle</h4><p>The problem is still a pathfinding problem in a given graph.
Once the problem is encoded as a graph search, it is possible to reuse
our existing tools for this purpose.</p><p>We consider the <em>product graph</em> of position, time, and speed.
This means that every graph element contains these 3 variables
(among other things)</p><p>Every graph edge is computed using
<a href=https://osrd.fr/en/docs/explanation/running_time_calculation/ title="running-time calculation">running-time calculation</a>
to get speed and positions as functions of time.</p><h4 id=graphical-representation>Graphical representation</h4><p>Space is encoded with a graph that contains the physical infrastructure.</p><p><img src=routes_time_1.png alt="product graph (1/3)"></p><p>It is then &ldquo;duplicated&rdquo; at different times.</p><p><img src=routes_time_2.png alt="product graph (2/3)"></p><p>The nodes are then linked together in a way that reflects travel time.</p><p><img src=routes_time_3.png alt="product graph (3/3)"></p><h4 id=notes>Notes</h4><ul><li>The graph is constructed on the fly as it is explored.</li><li>It is <em>discretized</em> in time, to evaluate which nodes have already
been visited. We keep full accuracy of time values, but two nodes
at the same place and close times are considered identical.</li><li>Every edge is computed with a running time computation.</li><li>Speed isn&rsquo;t discretized or considered to check visited nodes,
it&rsquo;s only used to compute time.</li><li>By default, the train always goes as fast as it can
(while still following standard allowances).
It only slows down when necessary.</li></ul><h4 id=example>Example</h4><p>For example, with the following infrastructure, using the track graph:
<img src=example_infra.svg alt="Example infra"></p><p>Exploring the solution graph can give the following result:
<img src=example_graph.svg alt="Représentation du graphe"></p></div><div class=td-content style=page-break-before:always><h1 id=pg-74094845d6db946e31db476ef1c506a2>2.3 - Discontinuities and backtracking</h1><h4 id=the-discontinuity-problem>The discontinuity problem</h4><p>When a new graph edge is visited, a simulation is run to evaluate
its speed. But it is not possible to see beyond the current edge.
This makes it difficult to compute braking curves, because
they can span over several edges.</p><p><img src=discontinuity.png alt=Discontinuity></p><blockquote><p>This example illustrates the problem: by default
the first edge is explored by going at maximum speed.
The destination is only visible once the second edge is visited,
which doesn&rsquo;t leave enough distance to stop.</p></blockquote><h4 id=solution--backtracking>Solution : backtracking</h4><p>To solve this problem, when an edge is generated with a
discontinuity in the speed envelopes, the algorithm goes back
over the previous edges to create new ones that include the
decelerations.</p><p>To give a simplified example, on a path of 4 edges
where the train can accelerate or decelerate by 10km/h per edge:</p><p><img src=backtracking_1.png alt="Discontinuity (edge version, 1/2)"></p><p>For the train to stop at the end of route 4, it must be at most
at 10km/h at the end of edge 3. A new edge is then created on
edge 3, which ends at 10km/h. A deceleration is computed
backwards from the end of the edge back to the start,
until the original curve is met (or the start of the edge).</p><p>In this example, the discontinuity has only been moved to the
transition between edges 2 and 3. The process is then repeated
on edge 2, which gives the following result:</p><p><img src=backtracking_2.png alt="Discontinuity (edge version, 2/2)"></p><p>Old edges are still present in the graph as they can lead to other solutions.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-615ce0cf6c404cd85469e6285e5feb90>2.4 - Conflict avoidance</h1><p>While exploring the graph, it is possible to end up in locations that would
generate conflicts. They can be avoided by adding delay.</p><h4 id=shifting-the-departure-time>Shifting the departure time</h4><p>The departure time is defined as an interval in the module parameters:
the train can leave at a given time, or up to <code>x</code> seconds later.
Whenever possible, delay should be added by shifting the departure time.</p><blockquote><p>for example : a train can leave between 10:00 et 11:00. Leaving
at 10:00 would cause a conflict, the train actually needs to enter the
destination station 15 minutes later. Making the train leave at
10:15 solves the problem.</p></blockquote><p>In OSRD, this feature is handled by keeping track, for every edge,
of the maximum duration by which we can delay the departure time.
As long as this value is enough, conflicts are avoided this way.</p><p>This time shift is a value stored in every edge of the path.
Once a path is found, the value is summed over the whole path.
This is added to the departure time.</p><blockquote><p>For example :</p><ul><li>a train leaves between 10:00 and 11:00. The initial maximum
time shift is 1:00.</li><li>At some point, an edge becomes unavailable 20 minutes after the
train passage. The value is now at 20 for any edge accessed from here.</li><li>The departure time is then delayed by 5 minutes to avoid a conflict.
The maximum time shift value is now at 15 minutes.</li><li>This process is applied until the destination is found,
or until no more delay can be added this way.</li></ul></blockquote><h4 id=engineering-allowances>Engineering allowances</h4><p>Once the maximum delay is at 0, the delay needs to be added
between two points of the path.</p><p><img src=engineering_allowance.png alt="Engineering allowances (1/2)"></p><p>The idea is the same as the one used to fix speed discontinuities:
new edges are created, replacing the previous ones.
The new edges have an engineering allowance, to add the delay where
it is possible.</p><p><img src=engineering_allowance_edges.png alt="Engineering allowances (2/2)"></p><p>computing an
<a href=https://osrd.fr/en/docs/explanation/running_time_calculation/allowances/ title=allowances>engineering allowance</a>
is a feature of the running-time
calculation module. It adds a given delay between two points of
a path, without affecting the speeds on the rest of the path.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ed97b39b0c3816e4f1073f363957a3e3>2.5 - Standard allowance</h1><p>The STDCM module must be usable with
<a href=https://osrd.fr/en/docs/explanation/running_time_calculation/allowances/ title="marge de régularité">standard allowances</a>.
The user can set an allowance value, expressed either as a function of
the running time or the travelled distance. This time must be added to the
running time, so that it arrives later compared to its fastest possible
running time.</p><blockquote><p>For example: the user can set a margin of 5 minutes per 100km.
On a 42km long path that would take 10 minutes at best,
the train should arrive 12 minutes and 6 seconds after leaving.</p></blockquote><p>This can cause problems to detect conflicts, as an allowance would move
the end of the train slot to a later time.
The allowance must be considered when we compute conflicts as
the graph is explored.</p><p>The allowance must also follow the <a href=/pdf/MARECO.pdf>MARECO</a> model:
the extra time isn&rsquo;t added evenly over the whole path,
it is computed in a way that requires knowing the whole path.
This is done to optimize the energy used by the train.</p><h4 id=linear-margin-expressed-as-a-function-of-time>Linear margin expressed as a function of time</h4><p>As a first step, the problem is solved with a linear margin,
i.e. added evenly over the whole path.
The speed is simply modified by a constant factor.</p><p>The <a href=https://osrd.fr/en/docs/explanation/running_time_calculation/envelopes_system/ title=envelopes>envelopes</a>.
computed during the graph traversal are not modified, they are always
at maximum speed. But they are paired with a speed factor, which is used
to compute running time and to evaluate conflicts.</p><p>The final envelope, with the allowance, is only computed once a path
is found.</p><h4 id=linear-margin-expressed-as-a-function-of-distance>Linear margin expressed as a function of distance</h4><p>The principle is generally the same, but with an extra difficulty:
the speed factor isn&rsquo;t constant over the path.
When a train goes faster, it travels more distance in the same time,
which increases the allowance time and the speed factor.</p><p>Because the train speed changes over the path, the speed factor
changes from one edge to another. This causes irregular speed curves.</p><h4 id=mareco-allowances>MARECO Allowances</h4><p>This is exclusively a post-processing step,
because it isn&rsquo;t possible to compute the MARECO envelope
without knowing the full train path.
When looking for a path, linear allowances are used.</p><p>This means that conflicts may appear at this step.
To avoid them, the following procedure is applied:</p><ol><li>A mareco allowance is applied over the whole path.</li><li>If there are conflict, the first one is considered.</li><li>The mareco allowance is <em>split in two intervals</em>.
The point where the first conflict appeared is set
to be at the same time as the envelope with a linear allowance,
removing the conflict at this point.</li><li>This process is repeated iteratively until no conflict is found.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-460b1be4e2f2584372a451ceef833731>2.6 - Implementation details</h1><p>This page is about implementation details.
It isn&rsquo;t necessary to understand general principles,
but it helps before reading the code.</p><h4 id=stdcmedgebuilder>STDCMEdgeBuilder</h4><p>This refers to
<a href=https://github.com/osrd-project/osrd/blob/dev/core/src/main/java/fr/sncf/osrd/stdcm/graph/STDCMEdgeBuilder.java>this class</a>
in the project.</p><p>This class is used to make it easier to create instances of
<code>STDCMEdge</code>, the graph edges. Those contain many attributes,
most of which can be determined from the context (e.g. the
previous node).
The <code>STDCMEdgeBuilder</code> class makes some parameters optional
and automatically computes others.</p><p>Once instantiated and parametrized, an <code>STDCMEdgeBuilder</code> has two methods:</p><ul><li><p><code>Collection&lt;STDCMEdge> makeAllEdges()</code> can be used to create all
the possible edges in the given context for a given route.
If there are several &ldquo;openings&rdquo; between occupancy blocks, one edge
is instantiated for each opening. Every conflict, their avoidance,
and their related attributes are handled here.</p></li><li><p><code>STDCMEdge findEdgeSameNextOccupancy(double timeNextOccupancy)</code>:
This method is used to get the specific edges that uses a certain
opening (when it exists), identified here with the time of the next
occupancy block. It is called whenever a new edge must be re-created
to replace an old one. It calls the previous method.</p></li></ul><h3 id=pathfinding>Pathfinding</h3><p>The methods mentioned here are defined in
<a href=https://github.com/osrd-project/osrd/blob/dev/core/src/main/java/fr/sncf/osrd/stdcm/graph/STDCMPathfinding.java>this class</a>.</p><h4 id=cost-function>Cost function</h4><p>The function used to define pathfinding cost sets which path
is used over another. The result is always the one that minimizes
this cost (as long as the heuristic is admissible).</p><p>Here, two parameters are used: total run time and departure time.
The latter has a very small weight compared to the former,
so that the fastest path is found. More details
are explained in the documentation of those methods.</p><h4 id=heuristics>Heuristics</h4><p>The algorithm used to find a path is an A*, with a heuristic based
on geographical coordinates.</p><p>However, the coordinates of generated infrastructures are arbitrary
and don&rsquo;t reflect the track distance. It means that,
for the generated infrastructures, the path may not always be the
shortest one.</p><p>It would be possible to use this heuristic to determine whether
the current node can lead to a path that doesn&rsquo;t take
longer than the maximum allowed total run time. But for the same
reason, adding this feature would break any STDCM test on generated
infras. More details in
<a href=https://github.com/osrd-project/osrd/issues/2818>this issue</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8ee6423983b11793e61c99ce092f6373>3 - Signaling interface</h1><p>WIP</p><p>There&rsquo;s a draft of what we intend to do on the French page,
but it&rsquo;s still a work in progress.
The implementation hasn&rsquo;t been started.</p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/osrd-project/osrd aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 OSRD contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/mermaid@8.13.4/dist/mermaid.min.js integrity="sha512-JERecFUBbsm75UpkVheAuDOE8NdHjQBrPACfEQYPwvPG+fjgCpHAz1Jw2ci9EXmd3DdfiWth3O3CQvcfEg8gsA==" crossorigin=anonymous></script><style>.markmap>svg{width:100%;height:300px}</style><script>window.markmap={autoLoader:{manual:!0}}</script><script src=https://cdn.jsdelivr.net/npm/markmap-autoloader></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.928c8c2d8b4f463998503da833bc465b748d40b80287e0398a7e1a38ab1c87a2.js integrity="sha256-koyMLYtPRjmYUD2oM7xGW3SNQLgCh+A5in4aOKsch6I=" crossorigin=anonymous></script></body></html>