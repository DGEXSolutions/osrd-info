<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.100.2"><link rel=canonical type=text/html href=https://osrd.fr/en/docs/guides/><link rel=alternate type=application/rss+xml href=https://osrd.fr/en/docs/guides/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>How-to Guides | OSRD</title><meta name=description content="Recipes for addressing key problems and use-cases"><meta property="og:title" content="How-to Guides"><meta property="og:description" content="Recipes for addressing key problems and use-cases"><meta property="og:type" content="website"><meta property="og:url" content="https://osrd.fr/en/docs/guides/"><meta property="og:site_name" content="OSRD"><meta itemprop=name content="How-to Guides"><meta itemprop=description content="Recipes for addressing key problems and use-cases"><meta name=twitter:card content="summary"><meta name=twitter:title content="How-to Guides"><meta name=twitter:description content="Recipes for addressing key problems and use-cases"><link rel=preload href=/scss/main.min.2630e74a757979ae8749757fe871a2cda0da39b3bb48e31e858fd5b3e754a6f7.css as=style><link href=/scss/main.min.2630e74a757979ae8749757fe871a2cda0da39b3bb48e31e858fd5b3e754a6f7.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/en/><span class=navbar-logo><svg xmlns="http://www.w3.org/2000/svg" id="svg35" width="110.674" height="22"><style id="style1">.st9{fill:#fff}</style><g id="ok" transform="translate(-14.662 -25.176) scale(.12964)"><g id="g29"><path id="path23" d="M170.1 317.5c-2.9 12-4.3 25.1-4.3 39.2v7.2h24.5c-4.2-19.6-11.5-34.7-20.2-46.4z" class="st9"/><path id="path24" d="M113.1 279.2v29.4c4.5 1.7 9.3 3.9 14 6.8 12.6 7.8 22.2 18.6 28.6 32.3v-45.8c-5.1-4.5-10.2-8.1-15.2-11.1-9.5-5.6-19-9.2-27.4-11.6z" class="st9"/><path id="path25" d="M165.7 297.5c6.3-16.6 15.7-31.1 28-43.4v-59.9h-28z" class="st9"/><path id="path26" d="M173.5 305.6c7.8 9.1 14.9 20.5 20.3 34.5v-71.2c-8.9 10.7-15.7 22.9-20.3 36.7z" class="st9"/><path id="path27" d="M261.9 194.2h-58.1v51c17.4-13.8 36.5-21.4 52.5-25.5 2.7-.7 5.4.9 6.1 3.6.7 2.7-.9 5.3-3.6 6-16.8 4.3-37.4 12.8-55.1 29.1v46.9c4.3-9.2 9.9-17.4 16.8-24.3 13.9-13.8 31.1-20.9 45-24.5 2.7-.7 5.4.9 6.1 3.6.7 2.7-.9 5.4-3.6 6-7 1.8-14.9 4.6-22.7 8.8-28 15.2-41.6 42-41.6 81.7v7.2h58.1c11.5.0 20.8-9.3 20.8-20.8V215c.1-11.5-9.2-20.8-20.7-20.8z" class="st9"/><path id="path28" d="M145.7 282.3c3.3 2 6.7 4.2 10.1 6.8v-94.8H134c-11.5.0-20.8 9.3-20.8 20.8v53.8c9.6 2.4 21 6.5 32.5 13.4z" class="st9"/><path id="path29" d="M121.1 323.5c-2.7-1.6-5.4-2.9-8-4.1V343c0 11.5 9.3 20.8 20.8 20.8h17.2c-5.4-18.1-15.4-31.6-30-40.3z" class="st9"/></g><g id="g30"><path id="path30" d="M411.2 355.3c-45.6.0-79.4-31.3-79.4-77.5.0-46.8 33.8-76.3 79.4-76.3 45.8.0 79.6 29.5 79.6 76.3.0 46.2-33.8 77.5-79.6 77.5zm0-122.1c-24.7.0-41.7 19-41.7 44.5.0 26.4 17.1 45.4 41.7 45.4s41.9-19 41.9-45.4c-.1-25.5-17.2-44.5-41.9-44.5z" class="st9"/></g><g id="g32"><g id="g31"><path id="path31" d="M607.3 243.3c-6-7.6-16.9-12.6-26-12.6s-20.4 3.1-20.4 14.6c0 9.7 8.7 12.8 22.5 17.1 19.8 6.4 45.4 14.8 45.4 43.9.0 33.6-27 48.7-55.9 48.7-20.8.0-41.9-7.6-54.6-21l23.1-23.5c7 8.9 20 15.5 31.5 15.5 10.7.0 20.2-4.1 20.2-15.9.0-11.1-11.1-14.6-30.3-20.8-18.6-6-37.3-15.5-37.3-41.9.0-32.4 29.3-45.8 56.5-45.8 16.5.0 35.1 6.2 47.8 17.9z" class="st9"/></g></g><g id="g34"><g id="g33"><path id="path32" d="m753.3 351.4-31.5-57.9h-12v57.9h-34.6v-146h55.7c28 0 55.9 10.7 55.9 44.1.0 19.6-11.5 33.6-30.3 39.4l38.1 62.5zm-25-117.5h-18.8v34h16.7c11.3.0 25.6-2.9 25.6-17.7.0-13.7-13-16.3-23.5-16.3z" class="st9"/></g></g><g id="g35"><path id="path34" d="M884.9 351.4h-54.4v-146h52.8c41.4.0 83.5 17.3 83.5 72.6-.1 51.3-41.7 73.4-81.9 73.4zm-2.5-115.9h-17.5v85.4h16.7c25.2.0 48.5-10.3 48.5-42.9-.1-32.8-23.4-42.5-47.7-42.5z" class="st9"/></g></g></svg></span><span class=font-weight-bold>OSRD</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/en/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/en/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/en/blog/><span>Blog</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/fr/docs/guides/>Français</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.47ff26c1ac2e033057dcefaeadf1f532.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/en/docs/guides/>Return to the regular view of this page</a>.</p></div><h1 class=title>How-to Guides</h1><div class=lead>Recipes for addressing key problems and use-cases</div><ul><li>1: <a href=#pg-3ce54efed8813f1db94e060b5c4d3dba>Contribute to OSRD</a></li><ul><li>1.1: <a href=#pg-447ef90d37a1cd8a734c648d8c6dfc8e>Report issues</a></li><li>1.2: <a href=#pg-6b7c59f2efb6c7b3add25b04a63e3942>Contribute code</a></li><li>1.3: <a href=#pg-6a4bbd8a33a31373a2271e2003cd8d5f>Style guide</a></li><ul><li>1.3.1: <a href=#pg-d807e8178df334af7c93ed0e4b021fdd>Back-end</a></li><li>1.3.2: <a href=#pg-53dd3533e7509ff0ea0773799bcd2e23>Front-end</a></li><li>1.3.3: <a href=#pg-c279934946faaf1b9c53231507b4a433>Tests</a></li></ul><li>1.4: <a href=#pg-dd4202c260f5c017918a0012ac43efba>Review code</a></li></ul></ul><div class=content><p>How-to guides are recipes. They guide you through the steps involved in addressing key problems and use-cases. They are more advanced than tutorials and assume some knowledge of how OSRD works.</p></div></div><div class=td-content><h1 id=pg-3ce54efed8813f1db94e060b5c4d3dba>1 - Contribute to OSRD</h1><div class=lead>Learn about the how we work, and how you can work with us</div><p>First off, thanks for taking the time to contribute!</p><p>The following chapters are a set of guidelines for contributing to OSRD<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. If you have already contributed to open source projects before, you probably won&rsquo;t be surprised.
If you have not, it will probably help a lot!</p><h3 id=communicate>Communicate</h3><p>Chatting with other contributors is a great way to speed things up:</p><ul><li>Join our instant messaging room on IRC at <a href=https://web.libera.chat/#osrd>libera.chat#osrd</a></li><li><a href=https://github.com/osrd-project/osrd/issues/new/choose><strong>Create an issue</strong></a> to discuss your contribution project</li></ul><h3 id=inquire>Inquire</h3><p>Just like with any project, changes rely on past work.
Before making changes, it is best to learn about what&rsquo;s already there:</p><ul><li><a href=https://osrd.fr/en/docs/>read technical documentation</a></li><li>read the existing source code related to your project</li><li>chat with developers who last worked on areas you are interested in</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>These guidelines are mostly not strict rules, it&rsquo;s probably fine to do things slightly differently.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=td-content style=page-break-before:always><h1 id=pg-447ef90d37a1cd8a734c648d8c6dfc8e>1.1 - Report issues</h1><div class=lead>Report a bug or suggest an enhancement</div><p><strong>Please report anything you deem significant!</strong></p><p>Our bug tracking platform is <a href=https://github.com/osrd-project/osrd/issues>github</a>, so you have to register to report bugs.</p><p>Follow <a href=https://github.com/osrd-project/osrd/issues/new/choose>this link</a> and pick whatever template fits the best.</p><h3 id=bugs>Bugs</h3><ul><li>Bug must have a correct description and the bug&rsquo;s issue template must be filled carefully.</li><li>Bug must be tagged with (<em>for team members</em>):<ul><li><code>kind:bug</code></li><li>one or several <code>area:&lt;affected_area></code> if possible, if the affected area is not known leave it blank it will be added later by another team member.</li><li>one <code>severity:&lt;bug_severity></code> if possible, if severity is not known leave it blank it will be added later by another team member.<ul><li><code>severity:minor</code>: User can still use the feature.</li><li><code>severity:major</code>: User sometimes can&rsquo;t use the feature.</li><li><code>severity:critical</code>: User can&rsquo;t use the feature.</li></ul></li></ul></li><li>OSRD team members can change issues&rsquo; tags (severity, area, kind, &mldr;).
You may leave a comment to explain changes.</li><li>If you are working on a bug or plan to work on a bug, assign yourself to the bug.</li><li>PRs solving bugs should add a regression tests to ensure that bug will not be back in the future.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-6b7c59f2efb6c7b3add25b04a63e3942>1.2 - Contribute code</h1><div class=lead>Integrate changes into OSRD</div><h2 id=set-things-up>Set things up</h2><div class="alert alert-info" role=alert>Most OSRD developers use Linux (incl. <a href=https://learn.microsoft.com/en-us/windows/wsl/>WSL</a>). Windows and MacOS should work too, but you may run into some issues.</div><h3 id=get-the-source-code>Get the source code</h3><ul><li>Install <a href=https://git-scm.com/><code>git</code></a>.<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></li><li>Open a terminal<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> in the folder where the source code of OSRD will be located</li><li>Run <code>git clone git@github.com:osrd-project/osrd</code></li></ul><h3 id=launch-the-application>Launch the application</h3><p>Thanks to <code>docker</code>, one can easily compile, configure, and run all services after making a change. One can also start only a subset of the services.</p><ul><li>Install <code>docker</code>. <sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup><sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></li><li>Follow <a href=https://github.com/osrd-project/osrd#getting-started>OSRD&rsquo;s README</a>.</li></ul><h2 id=share-your-changes>Share your changes</h2><div class="alert alert-warning" role=alert><p>The source code of OSRD is available under <a href=https://choosealicense.com/licenses/lgpl-3.0/>the LGPLv3 license</a>.
By contributing to the codebase, you consent to the distribution of your changes under the project&rsquo;s license.</p><p>LGPLv3 forbids modifying source code without sharing the changes under the same license: use other people&rsquo;s work, and share yours!</p><p>This constraint does not propagate through APIs: You can use OSRD as a library, framework or API server to interface with proprietary software. Please suggest changes if you need new interfaces.</p></div><p>This chapter is about the process of integrating changes into the common code base. <strong>If you need help at any stage, open an issue or message us.</strong></p><ol><li><p>If you are not used to Git, <a href=https://learngitbranching.js.org/>follow this tutorial</a></p></li><li><p><strong>Create a branch</strong><br>If you intend to contribute regularly, you can request access to the <a href=https://github.com/osrd-project/osrd>main repository</a>. Otherwise, <a href=https://github.com/osrd-project/osrd/fork>create a fork</a>.</p></li><li><p><strong>Add changes to your branch</strong><br>Before you start working, try to split your work into macroscopic steps.
At the end of each stop, save your changes into a commit.
Try to make commits of logical and atomic units.
Try to follow <a href=../conventions/>style conventions</a>.</p></li><li><p><strong>Keep your branch up-to-date</strong></p><pre tabindex=0><code>git switch &lt;your_branch&gt;
git fetch
git rebase origin/dev
</code></pre></li><li><p><strong>Open a pull request</strong><br>Once your changes are ready, you have to request integration with the <code>dev</code> branch.
If possible, make PR of logical and atomic units too (avoid mixing refactoring, new features and bug fix at the same time).
Add a description to PRs to explain what they do and why.
Help the reviewer by following advice given in <a href=https://mtlynch.io/code-review-love/>mtlynch article</a>.
Add tags <code>Area:&lt;affected_area></code> to show which part of the application have been impacted.
It can be done through <a href=https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/creating-a-pull-request>the web interface</a>.</p></li><li><p><strong>Take feedback into account</strong><br>Once your pull request is open, <a href=https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/about-pull-request-reviews>other contributors can review your changes</a>:</p><ul><li>Any user can review your changes</li><li>Your code has to be approved by a contributor <a href=https://github.com/osrd-project/osrd/blob/dev/.github/CODEOWNERS>familiar with the code</a></li><li>All users are expected to take comments into account.</li><li>Comments tend to be written in an open and direct manner.
The intent is to efficiently collaborate towards a solution we all agree on.</li><li>Once all discussions are resolved, a maintainer integrates the change.</li></ul><p>As a reviewer try to follow advice given in <a href=https://mtlynch.io/human-code-reviews-1/>mtlynch article</a>.</p></li><li><p><strong>If you believe somebody forgot to review / merge your change, please speak out, multiple times if needs be.</strong></p></li></ol><h2 id=git-commit-style>Git commit style</h2><p>The overall format for git commits is as follows:</p><pre tabindex=0><code>component: imperative description of the change

Detailed description of the change and what motivates it,
if it is not entirely obvious from the title.
</code></pre><ul><li><strong>the commit message, just like the code, must be in english</strong></li><li>all lowercase</li><li>there can be multiple components separated by <code>:</code> in case of hierarchical relationships, with <code>,</code> otherwise</li><li>the body of the commit should probably contain a detailed description of the change</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Under Linux, use your distribution&rsquo;s package manager, such as <code>apt-get</code>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Under Windows, open <code>Git Bash</code>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Under Windows/<a href=https://learn.microsoft.com/en-us/windows/wsl/tutorials/wsl-containers>WSL</a>, <a href=https://www.docker.com/products/docker-desktop/>Docker Desktop</a> is recommended&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=td-content style=page-break-before:always><h1 id=pg-6a4bbd8a33a31373a2271e2003cd8d5f>1.3 - Style guide</h1><div class=lead>Coding style guide and best practices</div><p>OSRD application is split in multiple services written in several languages. We try to follow general code best practices and follow specificity for each languages when required.</p><h2 id=general-rules>General rules</h2><ul><li>Explain what you&rsquo;re doing and why.</li><li>Document new code with doc comments.</li><li>Include clear, simple tests.</li><li>Break work into digestible chunks.</li><li>Take the time to pick good names.</li><li>Avoid non well-known abbreviations.</li><li><strong>Control and consistency over 3rd party code reuse</strong>: Only add a dependency if it is absolutely necessary.</li><li>Every dependency we add decreases our autonomy and consistency.</li><li><strong>Don&rsquo;t reinvent every wheel</strong>: As a counter to the previous point, don&rsquo;t reinvent everything at all costs.</li><li>If there is a dependency in the ecosystem that is the &ldquo;de-facto&rdquo; standard, we should heavily consider using it.</li><li>More code general recommendations in main repository <a href=https://github.com/osrd-project/osrd>CONTRIBUTING.md</a>.</li><li>Ask for any help that you need!</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d807e8178df334af7c93ed0e4b021fdd>1.3.1 - Back-end</h1><div class=lead>Coding style guide and best practices for back-end</div><h1 id=python>Python</h1><p>Python code is used for some packages and integration testing.</p><ul><li>Follow <a href=https://www.python.org/dev/peps/pep-0020/>the Zen of Python</a>.</li><li>Code is linted with <a href=https://github.com/csachs/pyproject-flake8>flake8</a>.</li><li>Code is formatted with <a href=https://github.com/psf/black>Black</a>.</li><li>Imports are sorted with <a href=https://github.com/PyCQA/isort>Isort</a>.</li><li>Python tests are written using <a href=https://docs.pytest.org/>pytest</a>.</li><li>Typing is checked using <a href=https://google.github.io/pytype/>pytype</a>.</li></ul><h1 id=rust>Rust</h1><ul><li>As a reference for our API development we are using the <a href=https://rust-lang.github.io/api-guidelines/about.html>Rust API guidelines</a>.
Generally, these should be followed.</li><li>Prefer granular imports over glob imports like <code>diesel::*</code>.</li><li>Tests are written with the <a href=https://doc.rust-lang.org/book/ch11-01-writing-tests.html>built-in testing framework</a>.</li><li>Use the <a href=https://doc.rust-lang.org/rust-by-example/meta/doc.html>documentation example</a> to know how to phrase and format your documentation.</li><li>Use consistent comment style:<ul><li><code>///</code> doc comments belong above <code>#[derive(Trait)]</code> invocations.</li><li><code>//</code> comments should generally go above the line in question, rather than in-line.</li><li>Start comments with capital letters. End them with a period if they are sentence-like.</li></ul></li><li>Use comments to organize long and complex stretches of code that can&rsquo;t sensibly be refactored into separate functions.</li><li>Code is linted with <a href=https://github.com/rust-lang/rust-clippy>clippy</a>.</li><li>Code is formatted with <a href=https://github.com/rust-lang/rustfmt>fmt</a>.</li></ul><h1 id=java>Java</h1><ul><li>Code is formatted with <a href=https://checkstyle.sourceforge.io/>checkstyle</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-53dd3533e7509ff0ea0773799bcd2e23>1.3.2 - Front-end</h1><div class=lead>Coding style guide and best practices for front-end</div><p>Nous utilisons <strong>ReactJS</strong> et tous les fichiers doivent être écrits en <strong>Typescript</strong>.</p><p>Le code est <strong>linté</strong> avec <a href=https://eslint.org/>eslint</a>, et <strong>formaté</strong> avec <a href=https://prettier.io/>prettier</a>.</p><h2 id=nomenclature>Nomenclature</h2><p><img src=../nomenclature-front-end.svg alt="Diagramme de l&amp;rsquo;Infrastructure"></p><p>Les <strong>applications</strong> (osrd eex, osrd stdcm, éditeur infra, éditeur matériel) proposent des <strong>vues</strong> (gestion des projets, gestions des études, etc.) liées à des <strong>modules</strong> (projet, étude, etc.) qui contiennent les composants.</p><p>Ces <strong>vues</strong> sont constituées de <strong>composants</strong> et sous-composants <u>tous issus des modules</u>.
En plus de contenir les fichiers de <strong>vues</strong> des applications, elles peuvent contenir un répertoire <strong>scripts</strong> qui propose des scripts liés à ces vues. Les <strong>vues</strong> déterminent la logique et l&rsquo;<u>accès au store</u>.</p><p>Les <strong>modules</strong> sont des collections de <strong>composants</strong> rattachés à un <strong>objet</strong> (un scénario, un matériel roulant, un TrainSchedule). Ils contiennent :</p><ul><li>un répertoire <em>components</em> qui héberge <u>tous</u> les composants</li><li>un répertoire <em>styles</em> optionnel <u>par module</u> pour le style des composants en scss</li><li>un répertoire <em>assets</em> optionnel <u>par module</u> (qui contient les assets, de jeux de données par défaut par ex, spécifiques au module)</li><li>un fichier <em>reducers</em> optionnel <u>par module</u></li><li>un fichier <em>types</em> optionnel <u>par module</u></li><li>un fichier <em>consts</em> optionnel <u>par module</u></li></ul><p>Un répertoire <strong>assets</strong> (qui contient les images et autre fichiers).</p><p>Enfin, un répertoire <strong>common</strong> qui propose :</p><ul><li>un répertoire <em>utils</em> pour les fonctions utilitaires communes à l&rsquo;ensemble du projet</li><li>un fichier <em>types</em> pour les types communs à l&rsquo;ensemble du projet</li><li>un fichier <em>consts</em> pour les constantes communes à l&rsquo;ensemble du projet</li></ul><h2 id=principes-dimplémentation>Principes d&rsquo;implémentation</h2><h3 id=routage--slug>Routage & SLUG</h3><p><em>Rédaction en cours</em></p><p><code>projects/{nom du projet}/studies/{nom de l'étude}/scenarios/{nom du scenario}</code></p><h3 id=styles--scss>Styles & SCSS</h3><p><em>Rédaction en cours</em></p><h3 id=storeredux>Store/Redux</h3><p>Tout ce qui est <em>selector</em> est géré par la <strong>vue</strong> passé en props aux composants et sous-composants.</p><p>Par conséquent les appels au store en lecture et en écriture doivent être passés un niveau de la vue, en irrigant par des <em>props</em> et <em>states</em> les composants proposées par la vue.</p><h3 id=rtk>RTK</h3><p><em>Rédaction en cours</em></p><p>Utiliser les endpoints générés à partir des fichiers <code>openapi.yaml</code> pour consommer le backend.</p><h2 id=lois-et-éléments-importants>Lois et éléments importants</h2><blockquote><p><strong>Aucun composant ne doit détenir la responsabilité de mise à jour de la donnée qu&rsquo;il utilise</strong></p><p>Seules <u>les vues</u> contiennent les sélecteurs du store, donnés ensuite en props aux composants du module lié à la vue.</p></blockquote><blockquote><p><strong>Le SCSS n&rsquo;est pas scopé</strong></p><p>Un fichier <code>.scss</code> enfoui dans l&rsquo;arborescence ne vous garantit pas que les classes contenues soient seulement accessibles à cet endroit, y compris par import react (formellement interdit au passage : vous devez utiliser l&rsquo;import SCSS), toutes les classes déclarées sont accessibles partout.</p><p>Préférez un choix judicieux de nom de classe racine pour un module donné et utilisez l&rsquo;arborescence possible dans le fichier SCSS.</p></blockquote><blockquote><p><strong>Les liens des imports doivent être absolus au sein d&rsquo;une application</strong></p><p>Vous devez utiliser le <u>chemin complet</u> pour tous vos imports, même si le fichier à importer se trouve dans le même répertoire.</p></blockquote><blockquote><p><strong>Les liens des imports doivent être relatifs au sein d&rsquo;un module ou d&rsquo;un composant</strong></p><p>Au sein d&rsquo;un module ou d&rsquo;un composant, à l&rsquo;instar d&rsquo;une librairie, les liens d&rsquo;imports doivent rester relatifs afin de permettre leur utilisation n&rsquo;importe où.</p></blockquote><h2 id=typescript>TypeScript</h2><h3 id=import--export>import & export</h3><p>We recommend using typed imports and exports.</p><p>When an <code>import</code> or <code>export</code> contains only types, indicate it with the <code>type</code> keyword.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#204a87;font-weight:700>export</span> <span style=color:#204a87;font-weight:700>type</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>Direction</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>DirectionalTrackRange</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>TrackRange</span> <span style=color:#000;font-weight:700>};</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#204a87;font-weight:700>type</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>typedEntries</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ValueOf</span> <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>from</span> <span style=color:#4e9a06>&#39;utils/types&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><p>This allows to:</p><ul><li>Improve the performance and analysis process of the compiler and the linter.</li><li>Make these declarations more readable; we can clearly see what we are importing.</li><li>Avoid dependency cycles:</li></ul><p><img src=./dependency-cycle.png alt="dependency cyle"></p><p>The error disappears with the <code>type</code> keyword</p><p><img src=./dependency-cycle-gone.png alt="dependency cyle"></p><ul><li>Make final bundle lighter (all types disappear at compilation)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-c279934946faaf1b9c53231507b4a433>1.3.3 - Tests</h1><div class=lead>Recommandations for testing purpose</div><h2 id=back-end>Back-end</h2><ul><li>Integration tests are written with <a href=https://docs.pytest.org/>pytest</a> in the <code>/tests</code> folder.</li><li>Each route described in the <code>openapi.yaml</code> files must have an integration test.</li><li>The test must check both the format and content of valid and invalid responses.</li></ul><h2 id=front-end>Front-end</h2><p>The functional writing of the tests is carried out with the <em>Product Owners</em>, and the developers choose a technical implementation that precisely meets the needs expressed and fits in with the recommendations presented here.</p><p>We use <a href=https://playwright.dev/>Playwright</a> to write end-to-end tests, and <a href=https://vitest.dev/>vitest</a> to write unit tests.</p><p>The browsers tested are currently <a href=https://www.mozilla.org/fr/firefox/switch/>Firefox</a> and Chromium.</p><h3 id=basic-principles>Basic principles</h3><ul><li>Tests must be <strong>short</strong> (1min max) and go <strong>straight to the point</strong>.</li><li>Arbitrary timeouts are outlawed; a test must systematically wait for a specific event. It is possible to use <em>polling</em> (retry an action - a click for example - after a certain time) proposed in the <a href=https://playwright.dev/>Playwright&rsquo;s</a> API.</li><li>All tests must be parallelizable.</li><li>Tests must not point to or wait for text elements from the translation, prefer the <em>DOM</em> tree structure or place specific <code>id</code>.</li><li>We&rsquo;re not testing the data, but the application and its functionality. Data-specific tests should be developed in parallel.</li></ul><h4 id=data>Data</h4><p><strong>The data tested must be public data</strong>.
The data required (infrastructure and rolling stock) for the tests are offered in the application&rsquo;s <code>json</code> files, <em>injected</em> at the start of each test and deleted at the end, regardless of its result or how it is stopped, including with <code>CTRL+C</code>.</p><p>This is done by API calls in typescript before launching the actual test.</p><p>The data tested is the same, both locally and via continuous integration.</p><h4 id=atomicity-of-a-test>Atomicity of a test</h4><p>Each test must be <strong>atomic</strong>: it is self-sufficient and cannot be divided.</p><p>A test will target a single feature or component, provided it is not too large. A test will not test an entire module or application; it will necessarily be a set of tests, in order to preserve test atomicity.</p><p>If a test needs elements to be created or added, these operations must be carried out by API calls in typescript upstream of the test, as is done for adding data. These elements must be deleted at the end of the test, regardless of the result or how it is stopped, including by <code>CTRL+C</code>.</p><p>This allows tests to be parallelized.</p><p>However, in certain cases where it is relevant, a test may contain several clearly explained and justified test subdivisions (several <code>test()</code> in a single <code>describe()</code>).</p><h3 id=example-of-a-test>Example of a test</h3><p>The requirement: &ldquo;We want to test the addition of a train to a timetable&rdquo;.</p><ol><li>add the test infrastructure and rolling stock to the database <strong>by API calls</strong>.</li><li>create project, study and scenario with choice of test infrastructure <strong>by API calls</strong>.</li><li>start the test, clicking on &ldquo;add one or more trains&rdquo; until the presence of the trains in the timetable is verified</li><li>the test passes, fails or is stopped, the project, study and scenario are deleted, along with the test rolling stock and infrastructure <strong>by API calls</strong>.</li></ol><p><em>NB: the test will not test all the possibilities offered by the addition of trains; this should be a specific test which would test the response of the interface for all scenarios without adding trains.</em></p></div><div class=td-content style=page-break-before:always><h1 id=pg-dd4202c260f5c017918a0012ac43efba>1.4 - Review code</h1><div class=lead>How to give useful feedback</div><figure><a href=https://www.morling.dev/blog/the-code-review-pyramid/><img src=/en/docs/guides/contribute/code-reviews/images/code_review_pyramid.svg></a></figure></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/osrd-project/osrd aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 OSRD contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/mermaid@8.13.4/dist/mermaid.min.js integrity="sha512-JERecFUBbsm75UpkVheAuDOE8NdHjQBrPACfEQYPwvPG+fjgCpHAz1Jw2ci9EXmd3DdfiWth3O3CQvcfEg8gsA==" crossorigin=anonymous></script><style>.markmap>svg{width:100%;height:300px}</style><script>window.markmap={autoLoader:{manual:!0}}</script><script src=https://cdn.jsdelivr.net/npm/markmap-autoloader></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.928c8c2d8b4f463998503da833bc465b748d40b80287e0398a7e1a38ab1c87a2.js integrity="sha256-koyMLYtPRjmYUD2oM7xGW3SNQLgCh+A5in4aOKsch6I=" crossorigin=anonymous></script></body></html>